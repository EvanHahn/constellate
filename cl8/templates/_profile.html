{% load gravatar %}
<div class="card-body">
    <h1 class="mb-0 text-3xl">{{ profile.name }}</h1>
    {% if profile.user == request.user %}
        <a href="{% url 'profile-edit' profile.short_id %}"
           class="btn btn-sm mt-2 mb-2 max-w-xs">Edit</a>
    {% endif %}
    {% if profile.photo %}
        <img src="{{ profile.detail_photo }}"
             width="250"
             height="250"
             alt="profile photo" />
    {% else %}
        {% gravatar profile.user.email 150 %}
    {% endif %}
    {% if profile_rendered_bio %}
        <h3>Bio</h3>
        <div class="prose">{{ profile_rendered_bio|safe }}</div>
    {% endif %}
    {% if grouped_tags %}
        {% for tag_group, tags in grouped_tags.items %}
            <h3>{{ tag_group }}</h3>
            <p>
                {% for tag_dict in tags %}
                    <span class="badge my-2 mx-1 p-4"
                          data-tag-name="{{ tag_dict.name }}"
                          data-tag-group="{{ tag_group }}">{{ tag_dict.name }}</span>
                {% endfor %}
            </p>
        {% endfor %}
    {% endif %}
    {% if ungrouped_tags %}
        <h3>Other Tags</h3>
        <p>
            {% for tag_dict in ungrouped_tags %}
                <span class="badge my-2 mx-1 p-4"
                      data-tag-name="{{ tag_dict.name }}"
                      data-tag-group="{{ tag_group }}">{{ tag_dict.name }}</span>
            {% endfor %}
        </p>
    {% endif %}
    <script>
        // when a user clicks on a tag, emit an event listing the nane of the tag being clicked
        // this is picked up by the parent component and used to filter the list of profiles
        // shown    
        document.querySelectorAll('.badge').forEach(item => {
            item.addEventListener('click', event => {
                document.body.dispatchEvent(new Event("toggle", ))
                event.target.classList.toggle('bg-blue-500')
                console.log(event)
            })
        })
    </script>
</div>
